  0%|                                                                                                                                    | 0/116 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  9%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                                                                                                                | 10/116 [05:48<27:55, 15.81s/it]
{'loss': 4.9491, 'grad_norm': 0.24151620268821716, 'learning_rate': 0.00029732142857142853, 'epoch': 0.09}
{'loss': 4.659, 'grad_norm': 0.1716337651014328, 'learning_rate': 0.00028392857142857137, 'epoch': 0.17}
                                                                                                                                                                 
{'eval_loss': 2.292255163192749, 'eval_runtime': 184.9731, 'eval_samples_per_second': 0.827, 'eval_steps_per_second': 0.211, 'epoch': 0.17}
[2;36m[2025-02-07 16:55:43][0m[2;36m [0m[33mWARNING [0m [1m[[0m[1;36m2025[0m-[1;36m02[0m-[1;36m07[0m [1;92m16:55:43[0m[1m][0m - WARNING - rich - Error during model saving: [1m[[0mErrno [1;36m20[0m[1m][0m Not a directory:                 ]8;id=231148;file:///home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py\[2mtrain_qlora.py[0m]8;;\[2m:[0m]8;id=471029;file:///home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py#398\[2m398[0m]8;;\
[2;36m                      [0m         [32m'/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/templates/modelcard_template.md'[0m                                                                   [2m                  [0m
[2;36m                     [0m[2;36m [0m[1;31mERROR   [0m [1m[[0m[1;36m2025[0m-[1;36m02[0m-[1;36m07[0m [1;92m16:55:43[0m[1m][0m - ERROR - rich - Training failed: [1m[[0mErrno [1;36m20[0m[1m][0m Not a directory:                             ]8;id=795667;file:///home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py\[2mtrain_qlora.py[0m]8;;\[2m:[0m]8;id=844962;file:///home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py#416\[2m416[0m]8;;\
[2;36m                      [0m         [32m'/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/templates/modelcard_template.md'[0m                                                                   [2m                  [0m
[2;36m                     [0m[2;36m [0m[1;31mERROR   [0m [1m[[0m[1;36m2025[0m-[1;36m02[0m-[1;36m07[0m [1;92m16:55:43[0m[1m][0m - ERROR - rich - Unhandled exception: [1m[[0mErrno [1;36m20[0m[1m][0m Not a directory:                         ]8;id=163032;file:///home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py\[2mtrain_qlora.py[0m]8;;\[2m:[0m]8;id=225772;file:///home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py#450\[2m450[0m]8;;\
[2;36m                      [0m         [32m'/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/templates/modelcard_template.md'[0m                                                                   [2m                  [0m
[2;36m                      [0m         Traceback [1m([0mmost recent call last[1m)[0m:                                                                              [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py"[0m, line [1;36m382[0m, in custom_save_pretrained  [2m                  [0m
[2;36m                      [0m             [1;35mtrainer.model.save_pretrained[0m[1m([0m                                                                              [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/peft_model.py"[0m, line     [2m                  [0m
[2;36m                      [0m         [1;36m321[0m, in save_pretrained                                                                                         [2m                  [0m
[2;36m                      [0m             [1;35mself.create_or_update_model_card[0m[1m([0msave_directory[1m)[0m                                                            [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/peft_model.py"[0m, line     [2m                  [0m
[2;36m                      [0m         [1;36m1360[0m, in create_or_update_model_card                                                                            [2m                  [0m
[2;36m                      [0m             card = [1;35mModelCard.load[0m[1m([0mfilename[1m)[0m if [1;35mos.path.exists[0m[1m([0mfilename[1m)[0m else [1;35mModelCard.from_template[0m[1m([0m[1;35mModelCardData[0m[1m([0m[1m)[0m[1m)[0m   [2m                  [0m
[2;36m                      [0m                                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   [2m                  [0m
[2;36m                      [0m           File                                                                                                          [2m                  [0m
[2;36m                      [0m         [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/repocard.py"[0m, line [1;36m416[0m, in from_template                                                           [2m                  [0m
[2;36m                      [0m             return [1;35msuper[0m[1m([0m[1m)[0m[1;35m.from_template[0m[1m([0mcard_data, template_path, template_str, **template_kwargs[1m)[0m                     [2m                  [0m
[2;36m                      [0m                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                     [2m                  [0m
[2;36m                      [0m           File                                                                                                          [2m                  [0m
[2;36m                      [0m         [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/repocard.py"[0m, line [1;36m332[0m, in from_template                                                           [2m                  [0m
[2;36m                      [0m             template_str = [1;35mPath[0m[1m([0mcls.default_template_path[1m)[0m[1;35m.read_text[0m[1m([0m[1m)[0m                                                  [2m                  [0m
[2;36m                      [0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                  [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/pathlib.py"[0m, line [1;36m1058[0m, in read_text        [2m                  [0m
[2;36m                      [0m             with [1;35mself.open[0m[1m([0m[33mmode[0m=[32m'r'[0m, [33mencoding[0m=[35mencoding[0m, [33merrors[0m=[35merrors[0m[1m)[0m as f:                                            [2m                  [0m
[2;36m                      [0m                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                  [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/pathlib.py"[0m, line [1;36m1044[0m, in open             [2m                  [0m
[2;36m                      [0m             return [1;35mio.open[0m[1m([0mself, mode, buffering, encoding, errors, newline[1m)[0m                                            [2m                  [0m
[2;36m                      [0m                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                            [2m                  [0m
[2;36m                      [0m         NotADirectoryError: [1m[[0mErrno [1;36m20[0m[1m][0m Not a directory:                                                                 [2m                  [0m
[2;36m                      [0m         [32m'/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/templates/modelcard_template.md'[0m                                                                   [2m                  [0m
[2;36m                      [0m                                                                                                                         [2m                  [0m
[2;36m                      [0m         During handling of the above exception, another exception occurred:                                             [2m                  [0m
[2;36m                      [0m                                                                                                                         [2m                  [0m
[2;36m                      [0m         Traceback [1m([0mmost recent call last[1m)[0m:                                                                              [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py"[0m, line [1;36m447[0m, in [1m<[0m[1;95mmodule[0m[39m>[0m                [2m                  [0m
[2;36m                      [0m         [39m    [0m[1;35mtrain[0m[1;39m([0m[1;39m)[0m                                                                                                     [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py"[0m[39m, line [0m[1;36m414[0m[39m, in train[0m                   [2m                  [0m
[2;36m                      [0m         [39m    [0m[1;35mtrainer.train[0m[1;39m([0m[1;39m)[0m                                                                                             [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/trainer.py"[0m[39m, [0m    [2m                  [0m
[2;36m                      [0m         [39mline [0m[1;36m2171[0m[39m, in train[0m                                                                                             [2m                  [0m
[2;36m                      [0m         [39m    return [0m[1;35minner_training_loop[0m[1;39m([0m                                                                                 [2m                  [0m
[2;36m                      [0m         [39m           ^^^^^^^^^^^^^^^^^^^^[0m                                                                                 [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/trainer.py"[0m[39m, [0m    [2m                  [0m
[2;36m                      [0m         [39mline [0m[1;36m2598[0m[39m, in _inner_training_loop[0m                                                                              [2m                  [0m
[2;36m                      [0m         [39m    [0m[1;35mself._maybe_log_save_evaluate[0m[1;39m([0m                                                                              [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/trainer.py"[0m[39m, [0m    [2m                  [0m
[2;36m                      [0m         [39mline [0m[1;36m3078[0m[39m, in _maybe_log_save_evaluate[0m                                                                          [2m                  [0m
[2;36m                      [0m         [39m    [0m[1;35mself._save_checkpoint[0m[1;39m([0m[39mmodel, trial[0m[1;39m)[0m                                                                         [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/trainer.py"[0m[39m, [0m    [2m                  [0m
[2;36m                      [0m         [39mline [0m[1;36m3209[0m[39m, in _save_checkpoint[0m                                                                                  [2m                  [0m
[2;36m                      [0m         [39m    [0m[1;35mself.save_model[0m[1;39m([0m[39moutput_dir, [0m[33m_internal_call[0m[39m=[0m[3;92mTrue[0m[1;39m)[0m                                                            [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/transformers/trainer.py"[0m[39m, [0m    [2m                  [0m
[2;36m                      [0m         [39mline [0m[1;36m3831[0m[39m, in save_model[0m                                                                                        [2m                  [0m
[2;36m                      [0m         [39m    [0m[1;35mself._save[0m[1;39m([0m[39moutput_dir[0m[1;39m)[0m                                                                                      [2m                  [0m
[2;36m                      [0m         [39m  File [0m[32m"/home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py"[0m[39m, line [0m[1;36m407[0m[39m, in <lambda[0m[1m>[0m                [2m                  [0m
[2;36m                      [0m             trainer._save = lambda output_dir: [1;35mcustom_save_pretrained[0m[1m([0mtrainer, output_dir[1m)[0m                              [2m                  [0m
[2;36m                      [0m                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                              [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/projects/dl-lib/FinsightAI/src/main/train_qlora.py"[0m, line [1;36m400[0m, in custom_save_pretrained  [2m                  [0m
[2;36m                      [0m             [1;35mtrainer.model.save_pretrained[0m[1m([0m                                                                              [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/peft_model.py"[0m, line     [2m                  [0m
[2;36m                      [0m         [1;36m321[0m, in save_pretrained                                                                                         [2m                  [0m
[2;36m                      [0m             [1;35mself.create_or_update_model_card[0m[1m([0msave_directory[1m)[0m                                                            [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/peft_model.py"[0m, line     [2m                  [0m
[2;36m                      [0m         [1;36m1360[0m, in create_or_update_model_card                                                                            [2m                  [0m
[2;36m                      [0m             card = [1;35mModelCard.load[0m[1m([0mfilename[1m)[0m if [1;35mos.path.exists[0m[1m([0mfilename[1m)[0m else [1;35mModelCard.from_template[0m[1m([0m[1;35mModelCardData[0m[1m([0m[1m)[0m[1m)[0m   [2m                  [0m
[2;36m                      [0m                                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   [2m                  [0m
[2;36m                      [0m           File                                                                                                          [2m                  [0m
[2;36m                      [0m         [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/repocard.py"[0m, line [1;36m416[0m, in from_template                                                           [2m                  [0m
[2;36m                      [0m             return [1;35msuper[0m[1m([0m[1m)[0m[1;35m.from_template[0m[1m([0mcard_data, template_path, template_str, **template_kwargs[1m)[0m                     [2m                  [0m
[2;36m                      [0m                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                     [2m                  [0m
[2;36m                      [0m           File                                                                                                          [2m                  [0m
[2;36m                      [0m         [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/repocard.py"[0m, line [1;36m332[0m, in from_template                                                           [2m                  [0m
[2;36m                      [0m             template_str = [1;35mPath[0m[1m([0mcls.default_template_path[1m)[0m[1;35m.read_text[0m[1m([0m[1m)[0m                                                  [2m                  [0m
[2;36m                      [0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                  [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/pathlib.py"[0m, line [1;36m1058[0m, in read_text        [2m                  [0m
[2;36m                      [0m             with [1;35mself.open[0m[1m([0m[33mmode[0m=[32m'r'[0m, [33mencoding[0m=[35mencoding[0m, [33merrors[0m=[35merrors[0m[1m)[0m as f:                                            [2m                  [0m
[2;36m                      [0m                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                  [2m                  [0m
[2;36m                      [0m           File [32m"/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/pathlib.py"[0m, line [1;36m1044[0m, in open             [2m                  [0m
[2;36m                      [0m             return [1;35mio.open[0m[1m([0mself, mode, buffering, encoding, errors, newline[1m)[0m                                            [2m                  [0m
[2;36m                      [0m                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                            [2m                  [0m
[2;36m                      [0m         NotADirectoryError: [1m[[0mErrno [1;36m20[0m[1m][0m Not a directory:                                                                 [2m                  [0m
[2;36m                      [0m         [32m'/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/huggingface_hub-0.27.0-py3.8.egg/hug[0m [2m                  [0m
[2;36m                      [0m         [32mgingface_hub/templates/modelcard_template.md'[0m                                                                   [2m                  [0m
