  0%|                                                                                                                                            | 0/512 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [16:58:12<00:00, 92.73s/it]/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /HuggingFaceTB/SmolLM2-1.7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fa63f6c12d0>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: f7c1bc72-6b65-4039-ae39-44b25a6c43e4)') - silently ignoring the lookup for the file config.json in HuggingFaceTB/SmolLM2-1.7B-Instruct.
{'loss': 4.9837, 'grad_norm': 0.15200799703598022, 'learning_rate': 0.0002, 'epoch': 0.04}
{'loss': 4.5067, 'grad_norm': 0.4169948399066925, 'learning_rate': 0.0002, 'epoch': 0.08}
{'loss': 4.2293, 'grad_norm': 0.19715851545333862, 'learning_rate': 0.0002, 'epoch': 0.12}
{'loss': 3.9037, 'grad_norm': 0.20697236061096191, 'learning_rate': 0.0002, 'epoch': 0.16}
{'loss': 3.9809, 'grad_norm': 0.282831609249115, 'learning_rate': 0.0002, 'epoch': 0.2}
{'loss': 3.7981, 'grad_norm': 0.1869506686925888, 'learning_rate': 0.0002, 'epoch': 0.23}
{'loss': 3.7592, 'grad_norm': 0.3020479083061218, 'learning_rate': 0.0002, 'epoch': 0.27}
  warnings.warn(                                                                                                                                                         
{'eval_loss': 1.8247706890106201, 'eval_runtime': 4808.7815, 'eval_samples_per_second': 0.284, 'eval_steps_per_second': 0.071, 'epoch': 0.29}
{'loss': 3.7392, 'grad_norm': 0.2059849053621292, 'learning_rate': 0.0002, 'epoch': 0.31}
{'loss': 3.672, 'grad_norm': 0.23070068657398224, 'learning_rate': 0.0002, 'epoch': 0.35}
{'loss': 3.6146, 'grad_norm': 0.20064669847488403, 'learning_rate': 0.0002, 'epoch': 0.39}
{'loss': 3.4173, 'grad_norm': 0.22526134550571442, 'learning_rate': 0.0002, 'epoch': 0.43}
{'loss': 3.7381, 'grad_norm': 0.350430965423584, 'learning_rate': 0.0002, 'epoch': 0.47}
{'loss': 3.3487, 'grad_norm': 0.21850501000881195, 'learning_rate': 0.0002, 'epoch': 0.51}
{'loss': 3.3571, 'grad_norm': 0.26404625177383423, 'learning_rate': 0.0002, 'epoch': 0.55}
{'loss': 3.1115, 'grad_norm': 0.2767755687236786, 'learning_rate': 0.0002, 'epoch': 0.59}
{'eval_loss': 1.6874864101409912, 'eval_runtime': 5075.063, 'eval_samples_per_second': 0.269, 'eval_steps_per_second': 0.067, 'epoch': 0.59}
{'loss': 3.4252, 'grad_norm': 0.22079801559448242, 'learning_rate': 0.0002, 'epoch': 0.62}
{'loss': 3.2893, 'grad_norm': 0.2773182690143585, 'learning_rate': 0.0002, 'epoch': 0.66}
{'loss': 3.2662, 'grad_norm': 0.2441309541463852, 'learning_rate': 0.0002, 'epoch': 0.7}
{'loss': 3.4281, 'grad_norm': 0.21369950473308563, 'learning_rate': 0.0002, 'epoch': 0.74}
{'loss': 2.9822, 'grad_norm': 0.29433849453926086, 'learning_rate': 0.0002, 'epoch': 0.78}
{'loss': 3.1038, 'grad_norm': 0.2081114500761032, 'learning_rate': 0.0002, 'epoch': 0.82}
{'loss': 3.2296, 'grad_norm': 0.19852441549301147, 'learning_rate': 0.0002, 'epoch': 0.86}
{'eval_loss': 1.654811978340149, 'eval_runtime': 5084.9976, 'eval_samples_per_second': 0.269, 'eval_steps_per_second': 0.067, 'epoch': 0.88}
{'loss': 3.0196, 'grad_norm': 0.24115639925003052, 'learning_rate': 0.0002, 'epoch': 0.9}
{'loss': 3.1799, 'grad_norm': 0.2721922993659973, 'learning_rate': 0.0002, 'epoch': 0.94}
{'loss': 3.4731, 'grad_norm': 0.20261676609516144, 'learning_rate': 0.0002, 'epoch': 0.98}
/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in HuggingFaceTB/SmolLM2-1.7B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [16:58:25<00:00, 119.35s/it]
{'train_runtime': 61107.7012, 'train_samples_per_second': 0.067, 'train_steps_per_second': 0.008, 'train_loss': 3.5802147835493088, 'epoch': 1.0}
***** train metrics *****
  epoch                    =         1.0
  total_flos               =  33691118GF
  train_loss               =      3.5802
  train_runtime            = 16:58:27.70
  train_samples_per_second =       0.067
  train_steps_per_second   =       0.008
/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/utils/other.py:716: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /HuggingFaceTB/SmolLM2-1.7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fa61e5928d0>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: aadf19a9-a971-4dbf-a058-5c3f86af56b8)') - silently ignoring the lookup for the file config.json in HuggingFaceTB/SmolLM2-1.7B-Instruct.
  warnings.warn(
/home/zahemen/miniconda3/envs/transformer_LM/lib/python3.11/site-packages/peft/utils/save_and_load.py:246: UserWarning: Could not find a config file in HuggingFaceTB/SmolLM2-1.7B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 342/342 [4:43:11<00:00, 49.68s/it]
***** eval metrics *****
  epoch                   =        1.0
  eval_loss               =     1.6548
  eval_runtime            = 4:43:21.37
  eval_samples_per_second =       0.08
  eval_steps_per_second   =       0.02
